/*!
(C) Andrea Giammarchi, @WebReflection - Mit Style License
*/
var Database=(function(o){var i,G=5*1024*1024,q=" TABLE ",z="DROP",C=" EXISTS ",n="IF",h=[].concat,D=B("readT"),g=B("t"),y=o.document,d=o.SQLTransaction,k="openDatabase",j="_"+(""+Math.random()).slice(2),r="id INTEGER PRIMARY KEY AUTOINCREMENT",w=o.Array,t=w.isArray||function(J,I){I=J.call([]);return function H(K){return I==J.call(K)}}({}.toString),F=o.Object,f=F.defineProperty||function(J,H,I){J[H]=I.value;return J},e=v.prototype;function v(I){var H=this instanceof v?this:new v(I);I||(I={});f(H,j,{enumerable:!1,writable:!0,configurable:!0,value:o[k](H.name=I.name||y.domain||"db",H.version=I.version||"1.0",H.description=I.description||"data",H.size=I.size||G,p)});H[j][j]=H;return H}function x(H){return h.call([],H===i?[]:H)}function u(){delete this[j]}function s(I,H,J){H[0]||(H[0]=r);this.query("CREATE"+q+n+" NOT"+C+I+" ("+H.join(", ")+")",J);return this}function B(I){I+="ransaction";return function H(M,J,L){var K=this;if(a(J)){L=J;J=[]}K[j][I](function(Q){for(var T=x(M),N=x(J),P=0,R=T.length,S=(Q[j]={self:K,fn:L,i:R}),O;P<R;++P){Q.executeSql(T[P]||T[0],x(N[P]),l,A)}});return K}}function m(H,I){this.query(z+q+n+C+H,I);return this}function p(){}function A(I,H){if(I=I[j]){--I.i||(I.fn||p)({type:"error",error:H,db:I.self})}}function b(H,N,L){for(var O=this,P=[],M=!t(N)||typeof N[0]!="object"||!N[0]?[N]:N,K=0,J=M.length,I=w(M[0].length+1).join(", ?").slice(2);K<J;++K){P[K]="INSERT INTO "+H+" VALUES ("+I+")"}O.query(P,M,L);return O}function a(H){return typeof H=="function"}function E(H){return this.result.rows.item(H)}function l(I,H){if(I=I[j]){--I.i||(I.fn||p)({type:"success",result:H,item:E,length:H.rows.length,db:I.self})}}function c(I,J){var H=this,L,K;H.read("SELECT * FROM sqlite_master WHERE name = ?",x(I),function(M){if(M.type=="success"){K=M.result.rows.item(0);if(K&&K.type=="table"&&(K.tbl_name||K.name)==I){return H.query([z+q+I,K.sql],J)}M.type="error";M.error=M.result;delete M.result}J(M)})}e.close=u;e.create=s;e.drop=m;e.insert=b;e.read=D;e.query=g;e.truncate=c;return v}(this));