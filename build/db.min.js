/*!
(C) Andrea Giammarchi, @WebReflection - Mit Style License
*/
var Database=(function(n){function v(J){if(!(this instanceof v)){return new v(J)}var I=this;J||(J={});e(I,i,{enumerable:!1,writable:!0,configurable:!0,value:j(I.name=J.name||y.domain||"db",I.version=J.version||"1.0",I.description=J.description||"data",I.size=J.size||H,q)});I[i][i]=I;return I}function u(){}function t(J,I,K){I[0]||(I[0]=r);this.query("CREATE"+p+l+" NOT"+A+J+" ("+I.join(", ")+")",K);return this}function B(J){J+="ransaction";return function I(N,K,M){var L=this;if(typeof K=="function"){M=K;K=[]}L[i][J](function(R){for(var U=x(N),O=G(K),Q=0,S=E(U.length,O.length),T=(R[i]={self:L,fn:M,i:S}),P;Q<S;++Q){R.executeSql(U[Q]||U[0],O[Q],k,C)}});return L}}function m(I,J){this.query(z+p+l+A+I,J);return this}function C(J,I){if(J=J[i]){--J.i||(J.fn||q)({type:"error",error:I,db:J.self})}}function a(I,O,M){for(var P=this,Q=[],N=G(O),L=0,K=N.length,J=w(N[0].length+1).join(", ?").slice(2);L<K;++L){Q[L]="INSERT INTO "+I+" VALUES ("+J+")"}P.query(Q,N,M);return P}function k(J,I){if(J=J[i]){--J.i||(J.fn||q)({type:"success",result:I,item:c,length:I.rows.length,db:J.self})}}function b(J,K){var I=this,M,L;I.read("SELECT * FROM sqlite_master WHERE name = ?",x(J),function(N){if(N.type=="success"){L=N.result.rows.item(0);if(L&&L.type=="table"&&(L.tbl_name||L.name)==J){return I.query([z+p+J,L.sql],K)}N.type="error";N.error=N.result;delete N.result}K(N)})}function x(I){return g.call([],I===h?[]:I)}function q(){}function c(I){return this.result.rows.item(I)}function G(I){return !s(I)||typeof I[0]!="object"||!I[0]?[I]:I}var h,H=5*1024*1024,p=" TABLE ",z="DROP",A=" EXISTS ",l="IF",r="id INTEGER PRIMARY KEY AUTOINCREMENT",w=n.Array,o=n.Math,E=o.max,g=[].concat,D=B("readT"),f=B("t"),y=n.document,j=n.openDatabase,i="_"+(""+o.random()).slice(2),s=w.isArray||function(K,J){J=K.call([]);return function I(L){return J==K.call(L)}}({}.toString),F=n.Object,e=F.defineProperty||function(K,I,J){K[I]=J.value;return K},d=v.prototype;d.close=u;d.create=t;d.drop=m;d.insert=a;d.read=D;d.query=f;d.truncate=b;return v}(this));